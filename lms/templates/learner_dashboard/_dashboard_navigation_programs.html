<%
from django.conf import settings
%>

<%page expression_filter="h"/>
% if is_marketing:
<div class="programs-filter">
  <form methot="GET" id="programs-filter">
  <ul class="type">
  % for k, v in settings.PROGRAMS_FILTER:
    <li><input name="type" value="${k}" type="checkbox" class="filter-type">${v}</input></li>
  % endfor
  </ul>
  <ul class="course">
  % for c in courses:
    <li><input name="course" value="${c.id.to_deprecated_string()}" type="checkbox" ${c.id.to_deprecated_string() not in active_courses and 'disabled'} class="filter-course"><label>${c.display_name_with_default}</label></input></li>
  % endfor
  </ul>
  </form>
</div>
<div class="modal-loader"><div>Please wait...</div></div>
<script type="text/javascript">
    $(document).ready(function() {
        let searchParams = new URLSearchParams(window.location.search);
        var type = (searchParams.get('type') || '').split(',');
        var course = (searchParams.get('course') || '').split(',');

        $('#programs-filter').find('input').each(function(i, input) {
            if ((input.name == 'type' && type.indexOf(input.value) >= 0) || (input.name == 'course' && course.indexOf(input.value) >= 0)) {
                input.checked = true;
                input.disabled = false;
            }
        });
        $('#programs-filter').change(function(e) {
            var types = [];
            var courses = [];
            $('#programs-filter').find('input').each(function(i, input) {
                if (input.checked && input.name == 'type') {
                    types.push(encodeURIComponent(input.value));
                } else if (input.checked && input.name == 'course') {
                    courses.push(encodeURIComponent(input.value));
                }
            });
            $("body").addClass("answer-loading");
            window.location.search = "?type=" + types.join(',') + "&course=" + courses.join(',');
        });
    });
</script>
% endif
## This file is left intentionally blank and can be overridden using theming
