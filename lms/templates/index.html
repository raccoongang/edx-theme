<%page expression_filter="h"/>
<%inherit file="main.html" />
<%namespace name='static' file='static_content.html'/>
<%!
from django.utils.translation import ugettext as _
from django.core.urlresolvers import reverse

from openedx.core.djangolib.markup import HTML, Text
%>

<main id="main" aria-label="Content" tabindex="-1">
    <section class="home">

        <header>
            <div class="parallax-img"></div>
        </header>

        <h1 class="heading-title"><span>${_("Let's write the future. Together.")}</span></h1>

        % if settings.FEATURES.get('ENABLE_COURSE_DISCOVERY'):
        <div class="course-search">
            <form method="get" action="/courses">
                <label><span class="sr">${_("Search for a course")}</span>
                    <input class="search-input" name="search_query" type="text" placeholder='${_("Search")}...'>
                </label>
                <button class="search-button" type="submit">
                    <span class="icon fa fa-search" aria-hidden="true"></span><span class="sr">${_("Search")}</span>
                </button>
            </form>
        </div>
        % endif

        <div class="main-page-text">
            <p>${_("Start on your learning pathway by taking the Azure Fundamentals course.")}</p>
            <p>${_("Your Learning Team will register you for the instructor-led courses in the pathway aligned with your job role.")}</p>
            <p>${_("Take the exam after completing all the classes in your pathway to begin to earn a Microsoft role-based certification.")}</p>
            <p class="small">(${_("NOTE: Courses subject to change based on Microsoft program updates")})</p>
        </div>
        
        <div class="main-page-graphic">
            <img src="/static/${settings.DEFAULT_SITE_THEME}/images/graphic.png" alt="">
        </div>

      </header>
      % if not courses_data:
          <%include file="${courses_list}" />
      % else:
        % for category in courses_data:
        <section class="course-box">
          <h2 class="course-box__heading">${category}</h2>
          <p class="course-box__info">${courses_data.get(category, {}).get('description', '')}</p>
          <%
          courses=courses_data.get(category, {}).get('courses', '')
          %>
          <%include file="${courses_list}" args="courses=courses" /> 
        </section>
        % endfor
      % endif

    </section>
</main>

<a class="arrow-up" onclick="$('html,body').animate({scrollTop:0},'slow');return false;"><i class="fa fa-chevron-up" aria-hidden="true"></i></a>

% if show_homepage_promo_video:
<section id="video-modal" class="modal home-page-video-modal video-modal">
    <div class="inner-wrapper">
        <iframe title="YouTube Video" width="640" height="360" src="//www.youtube.com/embed/${homepage_promo_video_youtube_id}?showinfo=0" frameborder="0" allowfullscreen></iframe>
    </div>
</section>
% endif

<%block name="js_extra">
<script type="text/javascript">
  $(window).load(function () {
    if (getParameterByName('next')) {
      $('#login').trigger("click");
    }
  })

  // js for parallax
  $(window).scroll(function () {
    var scrollTop = $(window).scrollTop();
    var imgPos = scrollTop / 2 + 'px';
    $('.parallax-img').css('transform', 'translate3d(0, ' + imgPos + ', 0)');

    if ($(window).scrollTop() > 100) {
      $('.arrow-up').addClass('active');
    } else if ($(window).scrollTop() <= 100) {
      $('.arrow-up').removeClass('active');
    }

  });
  // js for parallax end

  // js for show more btn
  $('.show-more').click(function () {
    $('.fa-spinner').css('visibility', 'visible');
    setTimeout(function () {
      $('.fa-spinner').css('visibility', 'hidden');
      $('.courses-listing-item:visible:last').nextAll(':lt(8)').show().addClass('newElements');
      if ($('.courses-listing-item').is(':hidden')) {
        $('html, body').animate({scrollTop: $('.newElements:first').offset().top - 20}, 1000);
        $('.courses-listing-item').removeClass('newElements');
      } else {
        $('html, body').animate({scrollTop: $('.newElements:first').offset().top - 20}, 1000);
        $('.show-more').hide();
      }
    }, 300);
  });
  // js for show more btn end

</script>
</%block>

% if show_signup_immediately is not UNDEFINED:
 ## NOTE: This won't work in production, because anonymous views are cached, so it will
 ## show either with or without this extra js for 3 minutes at a time.
<script type="text/javascript">
  $(window).load(function () {
    $('#signup_action').trigger("click");
  });
</script>
% endif
